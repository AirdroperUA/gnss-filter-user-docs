# Робота під час виконання

## DR0 vs DR1

- **DR0**: нормальна робота. GNSS UBX пересилається на GPS UART FC.

- **DR1**: захисний режим. Пересилання GNSS на GPS UART FC блокується.

SNR-охоронець може також перевести у DR1 (якщо `SNR_EN` увімкнено), коли різниця між найсильнішим і найслабшим SNR супутника залишається аномально вузькою протягом заданого часу.

Це не дозволяє підозрілим даним GNSS потрапляти в FC, поки активний DR1.

## Приклад логів (GCS)

Нижче наведено приклад форматування статусних повідомлень у журналі повідомлень GCS.

![Приклад логів](../diagrams/log_example.png)

## Послідовність rejoin

Коли умови реєднання виконані:

1. Стартує таймер стабільності rejoin.

2. Опціонально запускається фаза blend на `BLEND_MS`.

3. Фільтр виходить з DR1 і відновлює DR0.

## Імпульс події DR1

- Пін: `B5` (у поточній прошивці).

- Поведінка: high на 3 секунди при кожному переході DR0 → DR1, потім low.

- Призначення: зовнішній логер/маяк/індикатор.

## Debug override

`FORCE_FC_GPS_FORWARD` існує в `src/main.cpp` для налагодження.

- `false` (за замовчуванням): пересилання блокується у DR1 (безпечна поведінка).

- `true`: GNSS пересилається навіть у DR1 (лише для дебагу, не рекомендовано при спуфінгу).

