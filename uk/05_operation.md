# Робота під час виконання

## DR0 vs DR1

- **DR0**: нормальна робота. GNSS UBX передається на GPS UART FC.
- **DR1**: захисний режим. Пересилання GNSS на GPS UART FC блокується.

SNR‑захист може також перевести у DR1 (якщо `SNR_EN` увімкнено), коли різниця між найсильнішим і найслабшим SNR супутників залишається аномально вузькою протягом заданого часу.

Це не дозволяє підозрілим даним GNSS потрапляти до FC, поки активний DR1.

Примітка щодо старту:

- `BOOT_DLYMS` додає стартове вікно затримки, протягом якого спуф/EKF‑тригери не переводять фільтр у DR1.
- Якщо DR1 з'являється одразу після вмикання і зникає після reset, збільшіть `BOOT_DLYMS`.

## Приклад логів (GCS)

Нижче наведено приклад форматування статусних повідомлень у журналі повідомлень GCS.

![Приклад логів](../diagrams/log_example.png)

## Послідовність повторного приєднання (rejoin)

Коли умови повторного приєднання виконані:

1. Запускається таймер стабільності повторного приєднання (rejoin).
2. За потреби запускається фаза blend на `BLEND_MS`.
3. Фільтр виходить з DR1 і відновлює DR0.

## Імпульс події DR1

- Пін: `B5` (у поточній прошивці).
- Поведінка: високий рівень на 3 секунди при кожному переході DR0 → DR1, потім низький.
- Призначення: зовнішній логер/маяк/індикатор.
